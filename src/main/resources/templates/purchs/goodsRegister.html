<!DOCTYPE html>
<html layout:decorate="~{layouts/layout}"
      lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title>ìƒí’ˆ ë“±ë¡</title>
    <!-- âœ… Bootstrap 5 CDN ì¶”ê°€ -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- toast grid -->
    <link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
    <script src="https://uicdn.toast.com/grid/latest/tui-grid.js"></script>

<style>
	#custom-container{
		background-color: #f8f9fa; /* ì—°í•œ íšŒìƒ‰ ë°°ê²½ */
		padding: 20px;
		border-radius: 10px;
		box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* ë°•ìŠ¤ ê·¸ë¦¼ì */
		margin-bottom: 20px;
	
	}
	/* ì˜µì…˜ ì¶”ê°€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .btn-custom {
	    width: auto; /* ë²„íŠ¼ í¬ê¸°ë¥¼ ìë™ ì¡°ì • */
	    min-width: 120px; /* ìµœì†Œ ë„ˆë¹„ ì„¤ì • */
	    padding: 10px 20px; /* íŒ¨ë”© ì¡°ì • */
	}
    
</style>
</head>
<body layout:fragment="content">
<div class="container mt-4" >
	<h2 class="mb-4">ìƒí’ˆ ë“±ë¡</h2>
	
    <form action="/purchs/register" method="post" enctype="multipart/form-data">
    	<!-- <input type="hidden" id="csrfToken" name="_csrf" th:value="${_csrf.token}"> -->
    	<div id="custom-container">
	    	<div class="row mb-3">
	            <div class="col-md-6">
	                <label class="form-label">ìƒí’ˆëª…</label>
	                <input type="text" class="form-control" name="goodsName" th:value="${ProductDTO.goodsName}">
	            </div>
	            <div class="col-md-6">
	                <label class="form-label">ìƒí’ˆë²ˆí˜¸</label>
	                <input type="text" class="form-control" name="goodsCode" th:value="${ProductDTO.goodsCode}" readonly>
	            </div>
	        </div>
	
	        <div class="row mb-3">
	            <div class="col-md-6">
	                <label class="form-label">ìƒí’ˆë¶„ë¥˜</label>
	                <select class="form-select" name="classificationId" >
	                    <option value="" selected>ì„ íƒ</option>
	                    <option th:each="cate:${catelist}" th:value="${cate.classificationId}" th:text="${cate.classificationName}"></option>
	                </select>
                </div>
	            <div class="col-md-6">
	                <label class="form-label">ë¸Œëœë“œ</label>
	                <div class="input-group">
	                    <input type="text" class="form-control" name="brandName" id="brandName" th:value="${ProductDTO.brandName}" data-bs-toggle="modal" data-bs-target="#brandModal" readonly></input>
	        			<input type="hidden" id="brandId" name="brandId" value="${ProductDTO.brandId}">
	                	<!-- ê³µí†µ ëª¨ë‹¬ í˜¸ì¶œ -->
						
						<!-- ë¸Œëœë“œ ëª¨ë‹¬ -->
						
						    <div th:replace="purchs/ModalTemplate :: ModalTemplate (
						    	'brandModal', 
						    	'modal-xl', 
						    	'ë¸Œëœë“œ ì¡°íšŒ', 
						    	'purchs/brandTable', 
						    	'purchs/brandFooter'
						    )"></div>
						

	                </div>
	            </div>
	        </div>
	
	        <div class="row mb-3">
	            <div class="col-md-6">
	                <label class="form-label">ê³µê¸‰ì²˜</label>
	                <div class="input-group">
	                    <input type="text" class="form-control" name="vendorName" id="vendorName" th:value="${ProductDTO.vendorName}" data-bs-toggle="modal" data-bs-target="#vendorModal"  readonly>
	                	<input type="hidden" id="vendorId" name="vendorId" value="${ProductDTO.vendorId}">
	                	<!-- ê±°ë˜ì²˜ ëª¨ë‹¬ -->
						    <div th:replace="purchs/ModalTemplate :: ModalTemplate (
						    'vendorModal', 
						    'modal-xl', 
						    'ê±°ë˜ì²˜ ì¡°íšŒ', 
						    'purchs/vendorTable', 
						    'purchs/brandFooter'
						    )"></div>
						
	                </div>
	            </div>
	            <div class="col-md-6">
	                <label class="form-label">ì›ê°€</label>
	                <input type="text" class="form-control" name="goodsCost" th:value="${ProductDTO.goodsCost}">
	            </div>
	        </div>
	
	        <div class="row mb-3">
	            <div class="col-md-6">
	                <label class="form-label">íŒë§¤ê°€</label>
	                <input type="text" class="form-control" name="goodsPrice" th:value="${ProductDTO.goodsPrice}">
	            </div>
	            <div class="col-md-6">
	                <label class="form-label">ê³µê¸‰ê°€ì•¡</label>
	                <input type="text" class="form-control" name="goodsSupplyPrice" th:value="${ProductDTO.goodsSupplyPrice}">
	            </div>
	        </div>
	
	        <div class="row mb-3">
	            <div class="col-md-6">
	                <label class="form-label">ê·œê²©</label>
	                <input type="text" class="form-control" name="goodsStandard" th:value="${ProductDTO.goodsStandard}">
	            </div>
	            <div class="col-md-6">
	                <label class="form-label">ë‹´ë‹¹ì</label>
	                <input type="text" class="form-control" name="employeeNum" th:value="${ProductDTO.employeeNum}" readonly>
	            </div>
	        </div>
	
	        <div class="row mb-3">
	            <div class="col-md-6">
	                <label class="form-label">ëŒ€í‘œ ì´ë¯¸ì§€</label>
	                <div class="input-group">
	                    <input type="file" class="form-control" id="goodsImage" name="goodsImage" th:value="${ProductDTO.goodsImage}" accept=".jpg, .jpeg, .png, .pdf"  placeholder="png, jpg, pdf ê°€ëŠ¥"   style="width: 400px;">
        				<button class="btn btn-outline-secondary" type="button" id="uploadImageBtn">ì—…ë¡œë“œ</button>
	                </div>
	                 	
	            		   	<!-- ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° -->
				        <div id="imagePreview" class="mt-3">
				            <img id="uploadedImage" src="" alt="ì—…ë¡œë“œëœ ì´ë¯¸ì§€" style="max-width: 300px; display: none;">
				        </div>
	            </div>
	            <div class="col-md-6">
	                <label class="form-label">ìƒí’ˆì„¤ëª…</label>
	                <div class="input-group">
	                    <textarea class="form-control" name="goodsDescription" rows="2" th:text="${ProductDTO.goodsDescription}"></textarea>
	                </div>
	            </div>
	        </div>
		
		</div>
       
        <div class="d-flex justify-content-between mb-3">
            <div>
                <input type="checkbox" id="singleRegister" name="registerType">
                <label for="singleRegister">ë‹¨ê±´ ë“±ë¡</label>
        
                <input type="checkbox" id="optionRegister" name="registerType">
                <label for="optionRegister">ì˜µì…˜ ë“±ë¡</label>
            </div>
        </div>
        <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-primary btn-custom" id="bttAdd">ì˜µì…˜ ì¶”ê°€</button>
        </div>
        <div id="myGrid" class="tui-grid-container" style="height: 200px;"></div>
        <div id="pagination" class="tui-pagination"></div>
          <!--  ì°½ê³  ëª¨ë‹¬ -->
		    <div th:replace="purchs/ModalTemplate :: ModalTemplate (
		    'warehouseModal', 
		    'modal-xl', 
		    'ì°½ê³  ì¡°íšŒ', 
		    'purchs/warehouseTable', 
		    'purchs/warehouseFooter'
		    )"></div>
        <div class=" d-flex justify-content-center mt-4">
            <button type="submit" class="btn btn-primary mx-2">ë“±ë¡</button>
            <button type="reset" class="btn btn-secondary mx-2">ì´ˆê¸°í™”</button>
        </div>
        
      
    </form>
</div>

<script>
let grid;



 document.addEventListener("DOMContentLoaded", function(){
    	
    	var Grid = tui.Grid;
        //ì…ë ¥ ì°½ì˜ ê²½ìš° 
        const dataSource = [];
        
        // ì‚¬ìš©ì ì •ì˜ ë Œë”ëŸ¬ (ì‚­ì œ ë²„íŠ¼ ì¶”ê°€)
        class DeleteRenderer {
            constructor(props) {
                const el = document.createElement('button');
                el.textContent = 'ì‚­ì œ';
                el.className = 'btnDelete btn btn-danger btn-sm';
                el.addEventListener('click', () => {
                    grid.removeRow(props.rowKey); // í´ë¦­ ì‹œ í•´ë‹¹ í–‰ ì‚­ì œ
                });
                this.el = el;
            }
            getElement() {
                return this.el;
            }
        }

        	 grid = new Grid({
            el: document.getElementById('myGrid'), // ì»¨í…Œì´ë„ˆ ì—˜ë¦¬ë¨¼íŠ¸
            rowHeaders: ['checkbox'], 
            columns: [ 
                {header : "ì˜µì…˜ì½”ë“œ" , name:"optionCode",className: "tui-grid-cell-readonly"},
                {header : "ì˜µì…˜ëª…" , name:"optionName" , editor: "text"},
                {header : "í˜„ì¬ì¬ê³ " , name:"currentAmount",className: "tui-grid-cell-readonly"},
                {header : "ì•ˆì „ì¬ê³ " , name:"optionSafetyInvoice" , className: "tui-grid-cell-readonly"},
                {header : "ìƒí’ˆìœ„ì¹˜" , name:"warehouseName" },
                {header : "ì°½ê³ id" , name:"warehouseId" , hidden: true},
                {
                    header : "ì‚­ì œ"
                    ,name: "delete"
                    ,renderer: {
                    type: DeleteRenderer // ì‚­ì œë²„íŠ¼ ì •ì˜ ë Œë”ëŸ¬
                    }  
                    ,cellStyle: { textAlign: "center" }
                    ,className: "tui-grid-cell-readonly"
                }
            ],
            data: dataSource
        });
        
        
        const singleRegister = document.getElementById("singleRegister");
        const optionRegister = document.getElementById("optionRegister");
        const bttAdd = document.getElementById("bttAdd");
         // ë‹¨ê±´ ì¡°íšŒê°€ ì´ë¯¸ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
        function isSingleRowExists() {
            return grid.getData().some(row => row.optionName === "ë‹¨ê±´");
        }

          // ëª¨ë“  í–‰ ì‚­ì œ í•¨ìˆ˜ (removeRow ì‚¬ìš©)
        function deleteAllRows() {
            const rowKeys = grid.getData().map(row => row.rowKey); // ëª¨ë“  í–‰ì˜ rowKeyë¥¼ ì–»ìŒ
            rowKeys.forEach(key => {
                grid.removeRow(key); // ê° í–‰ì„ ì‚­ì œ
            });
        }
        

        
        //ë‹¨ê±´ë“±ë¡ì‹œ ì²´í¬ë°•ìŠ¤ ìƒíƒœ 
        singleRegister.addEventListener("change", function(){
             // ì²´í¬ ìƒíƒœ ë³€ê²½ ì‹œ ê¸°ì¡´ í–‰ ì‚­ì œ
            deleteAllRows();

            if (this.checked) {
                if (!isSingleRowExists()) {
                    grid.appendRow({ optionName: "ë‹¨ê±´" }, { at: 0 }); // ì˜µì…˜ëª… "ë‹¨ê±´" ì¶”ê°€
                }
                // ë‹¨ê±´ì´ ì¶”ê°€ë˜ë©´ bttAdd ë¹„í™œì„±í™”
                bttAdd.disabled = true;
                optionRegister.checked= false;
            }else {
                bttAdd.disabled = false; // ë‹¤ì‹œ bttAdd ë²„íŠ¼ í™œì„±í™”
            }
        });
	// ì˜µì…˜ë“±ë¡ì‹œ ì²´í¬ë°•ìŠ¤
        optionRegister.addEventListener("change", function(){
            if(this.checked){
                grid.appendRow({}, { at: 0 }); // ë¹ˆ í–‰ ì¶”ê°€
                singleRegister.checked= false;
                bttAdd.disabled = false; // bttAdd ë²„íŠ¼ í™œì„±í™”
            }else {
                bttAdd.disabled = false; // ë‹¤ì‹œ bttAdd ë²„íŠ¼ í™œì„±í™”
            }
        });
	
     // Toast Grid ì…€ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ ì¶”ê°€
        grid.on('click', function(ev) {
            const { rowKey, columnName } = ev;

            // "ìƒí’ˆìœ„ì¹˜" ì»¬ëŸ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ ì—´ê¸°
            if (columnName === "warehouseName") {
                openWarehouseModal(rowKey);
            }
        });

        // ë²„íŠ¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
        // í–‰ì¶”ê°€
        bttAdd.addEventListener("click", function () {
            if (!singleRegister.checked && optionRegister.checked) {
                grid.appendRow({}, { at: 0 }); // ë¹ˆ í–‰ ì¶”ê°€
            }
        });
        

      //ë¸Œëœë“œ ëª¨ë‹¬ ì‘ì—… 
     // ëª¨ë‹¬ì´ ì—´ë¦´ ë•Œ ê·¸ë¦¬ë“œ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
     document.getElementById('brandModal').addEventListener('shown.bs.modal', function () {
	    console.log("ğŸ“¢ ëª¨ë‹¬ì´ ì—´ë¦¼. ê·¸ë¦¬ë“œ ë¦¬í”„ë ˆì‹œ ì‹¤í–‰!");
	
	    if (typeof brandGrid !== 'undefined' && brandGrid !== null) {
	    	brandGrid.readData(); // ëª¨ë‹¬ì´ ì—´ë¦¬ë©´ ë°ì´í„° ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
	        brandGrid.refreshLayout();
	        
	    } else {
	        console.warn(" brandGridê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
	    }
	});

    document.getElementById('brandModal').addEventListener('hidden.bs.modal', function () {
   	    console.log("ğŸ“¢ ëª¨ë‹¬ì´ ë‹«í˜. ì„ íƒëœ ë¸Œëœë“œë¥¼ inputì— ë°˜ì˜.");

   	    let selectedBrandName = sessionStorage.getItem("selectedBrandName");
   	    let selectedBrandId = sessionStorage.getItem("selectedBrandId");

   	    if (selectedBrandName && selectedBrandId) {
   	        let brandInput = document.getElementById("brandName");
   	        let brandIdInput = document.getElementById("brandId");

   	        if (brandInput && brandIdInput) {
   	            brandInput.value = selectedBrandName;
   	            brandIdInput.value = selectedBrandId;
   	        }

   	        console.log("ë¸Œëœë“œ ì„ íƒ ì™„ë£Œ:", selectedBrandName, selectedBrandId);
			
	   	 
   	     
   	        // âœ… ê°’ ì‚¬ìš© í›„ sessionStorageì—ì„œ ì‚­ì œ
   	        sessionStorage.removeItem("selectedBrandName");
   	        sessionStorage.removeItem("selectedBrandId");
   	    } else {
   	        console.warn("ì €ì¥ëœ ë¸Œëœë“œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
   	    }
   	});
    
    //ê±°ë˜ì²˜ ëª¨ë‹¬ ì‘ì—… 
    // ëª¨ë‹¬ì´ ì—´ë¦´ ë•Œ ê·¸ë¦¬ë“œ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
    document.getElementById('vendorModal').addEventListener('shown.bs.modal', function () {
	    console.log("ğŸ“¢ ëª¨ë‹¬ì´ ì—´ë¦¼. ê·¸ë¦¬ë“œ ë¦¬í”„ë ˆì‹œ ì‹¤í–‰!");
	
	    if (typeof vendorGrid !== 'undefined' && vendorGrid !== null) {
	    	vendorGrid.readData(); // ëª¨ë‹¬ì´ ì—´ë¦¬ë©´ ë°ì´í„° ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
	    	vendorGrid.refreshLayout();
	    	
	    } else {
	        console.warn(" brandGridê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
	    }
	});

   document.getElementById('vendorModal').addEventListener('hidden.bs.modal', function () {
  	    console.log("ğŸ“¢ ëª¨ë‹¬ì´ ë‹«í˜. ì„ íƒëœ ë¸Œëœë“œë¥¼ inputì— ë°˜ì˜.");

  	    let selectedVendorName = sessionStorage.getItem("selectedVendorName");
  	    let selectedVendorId = sessionStorage.getItem("selectedVendorId");

  	    if (selectedVendorName && selectedVendorId) {
  	        let vendorNameInput = document.getElementById("vendorName");
  	        let vendorIdInput = document.getElementById("vendorId");

  	        if (vendorNameInput && vendorIdInput) {
  	        	vendorNameInput.value = selectedVendorName;
  	        	vendorIdInput.value = selectedVendorId;
  	        }

  	        console.log("ë¸Œëœë“œ ì„ íƒ ì™„ë£Œ:", selectedVendorName, selectedVendorId);
			
	   	 
  	     
  	        // âœ… ê°’ ì‚¬ìš© í›„ sessionStorageì—ì„œ ì‚­ì œ
  	        sessionStorage.removeItem("selectedVendorName");
  	        sessionStorage.removeItem("selectedVendorId");
  	    } else {
  	        console.warn("ì €ì¥ëœ ë¸Œëœë“œ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
  	    }
  	});
   
   
// âœ… ì´ë¯¸ì§€ ì—…ë¡œë“œ ë²„íŠ¼ í´ë¦­ ì‹œ imgSave() ì‹¤í–‰
    document.getElementById("uploadImageBtn").addEventListener("click", imgSave);
   //ì´ë¯¸ì§€ ì €ì¥ í•¨ìˆ˜ 
   async function imgSave(){
	   console.log("ì‹¤í–‰!!")
       const fileInput = document.getElementById("goodsImage");
       const file = fileInput.files[0];
       
       const formData = new FormData();
       formData.append("file", file);
       
       return fetch("/purchs/rest/product/uploadGoodsImages", {
           method: "POST",
           body: formData
       })
       .then(response => response.text())
       .then(data => {
           return data;
       })
       .catch(error => {
           console.error("íŒŒì¼ ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
       });
   }
   
 //ì°½ê³  ëª¨ë‹¬ ì‘ì—…

function openWarehouseModal(rowKey) {
   	    sessionStorage.setItem("selectedRowKey", rowKey); // í´ë¦­í•œ í–‰(rowKey) ì €ì¥
   	
   	    // ëª¨ë‹¬ ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
   	    const modalElement = document.getElementById('warehouseModal');
   	    if (!modalElement) {
   	        console.error("warehouseModal ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
   	        return;
   	    }
   	    

   	    // ì°½ê³  ê·¸ë¦¬ë“œê°€ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸ í›„ ë°ì´í„° ê°±ì‹ 
   	    if (typeof warehouseGrid !== 'undefined' && warehouseGrid !== null) {
   	        console.log("ğŸ“¢ ì°½ê³  ëª¨ë‹¬: ë°ì´í„° ì´ˆê¸°í™” ë° ìƒˆë¡œê³ ì¹¨ ì‹œì‘");
   	
   	        // ê¸°ì¡´ ë°ì´í„° ì´ˆê¸°í™”
   	    
   	        let Data = warehouseGrid.getData();
   	        console.log("ê·¸ë¦¬ë“œë°ì´í„°",Data)
   	        console.log(bootstrap.Version);

   	        
   			 warehouseGrid.readData();
   	        
   	        setTimeout(() => {
   		        warehouseGrid.refreshLayout();  // ê¸°ì¡´ ë°ì´í„° ì´ˆê¸°í™”
   	        	
   			}, 500);
   	        

   	  
      

   	        // ë°ì´í„°ë¥¼ ë‹¤ ë¶ˆëŸ¬ì˜¨ í›„ ëª¨ë‹¬ ì—´ê¸° (onGridUpdated ì´ë²¤íŠ¸ í™œìš©)
   	         warehouseGrid.on("onGridUpdated", function () {
   	            console.log("ì°½ê³  ëª¨ë‹¬: ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ");
   	            

   	            // ë°ì´í„° ë¡œë“œ ì™„ë£Œ í›„ ëª¨ë‹¬ ì—´ê¸°
   	            const modalInstance = new bootstrap.Modal(modalElement);
   	            modalInstance.show(); // ëª¨ë‹¬ ì—´ê¸°
   	            
   	            
   	            console.log("ì°½ê³  ëª¨ë‹¬ ì—´ë¦¼:", rowKey);
   	        }); 
   	    } else {
   	        console.warn("warehouseGridê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
   	    } 
   	}
 
document.getElementById('warehouseModal').addEventListener('shown.bs.modal', function () {
	    console.log(" ì°½ê³  ëª¨ë‹¬ì´ ì—´ë ¸ìŠµë‹ˆë‹¤. ê·¸ë¦¬ë“œ ìƒˆë¡œê³ ì¹¨ ì‹¤í–‰");

	    if (typeof warehouseGrid !== 'undefined' && warehouseGrid !== null) {
	        warehouseGrid.readData();       // ğŸš€ ë°ì´í„° ìƒˆë¡œê³ ì¹¨
	  
	        console.log("ì°½ê³  ê·¸ë¦¬ë“œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ");
	    } else {
	        console.warn("warehouseGridê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
	    }
	}); 
	


		//âœ… ë‹«ê¸° ë²„íŠ¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ í›„ ì´ë²¤íŠ¸ ì¶”ê°€
		const btnClose = document.querySelector("#warehouseModal #btn-close");
		if (btnClose) {
		    btnClose.addEventListener("click", function () {
		        console.log("âœ… ë‹«ê¸° ë²„íŠ¼ í´ë¦­ë¨!");
		
		        // Bootstrap Modal ì¸ìŠ¤í„´ìŠ¤ ê°€ì ¸ì˜¤ê¸° ë˜ëŠ” ìƒì„±
		        const modalInstance = new bootstrap.Modal(warehouseModal);
		        
		        console.log("ëª¨ë‹¬ì¸ìŠ¤í„´ìŠ¤",modalInstance)
		        modalElement.classList.remove("show");
		        modalInstance.hide();
		        
		    });
		} else {
		    console.warn("âŒ btn-close ë²„íŠ¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ!");
		}

   // ëª¨ë‹¬ì´ ë‹«í ë•Œ ì„ íƒëœ ê°’ ê·¸ë¦¬ë“œì— ë°˜ì˜
   document.getElementById('warehouseModal').addEventListener('hidden.bs.modal', function () {
       console.log("ğŸ“¢ ìƒí’ˆ ìœ„ì¹˜ ëª¨ë‹¬ ë‹«í˜. ì„ íƒëœ ìœ„ì¹˜ë¥¼ ê·¸ë¦¬ë“œì— ë°˜ì˜.");
 

       let selectedWarehouseId = sessionStorage.getItem("selectedWarehouseId"); // ì°½ê³  ID ê°€ì ¸ì˜¤ê¸°
       let selectedWarehouseName = sessionStorage.getItem("selectedWarehouseName"); // ì°½ê³ ëª… ê°€ì ¸ì˜¤ê¸°
       let selectedRowKey = sessionStorage.getItem("selectedRowKey"); // í´ë¦­í•œ í–‰ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
       
       console.log("ë„˜ì–´ì˜¨ ë°ì´í„°",selectedWarehouseId,selectedWarehouseName,selectedRowKey)

       if (selectedWarehouseId && selectedWarehouseName && selectedRowKey) {
           grid.setValue(selectedRowKey, "warehouseId", selectedWarehouseId);
           grid.setValue(selectedRowKey, "warehouseName", selectedWarehouseName);
       } else {
           console.warn("ğŸ“¢ ì €ì¥ëœ ìƒí’ˆ ìœ„ì¹˜ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.");
       }

       sessionStorage.removeItem("selectedWarehouseId");
       sessionStorage.removeItem("selectedWarehouseName");
       sessionStorage.removeItem("selectedRowKey");
   });
        
    });
    
    
</script>

</body>


</html>
