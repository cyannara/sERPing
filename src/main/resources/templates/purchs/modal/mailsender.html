<body>
<!-- <script>

  // ë¸Œë¼ìš°ì € sessionStorageì—ì„œ ê°’ ê°€ì ¸ì˜¤ê¸°
  const vendorEmail = sessionStorage.getItem("vendorEmail"); 
  const employeeEmail = sessionStorage.getItem("employeeEmail");

  // ê°’ì´ ìˆìœ¼ë©´ í¼ì— ëŒ€ì…
  if (employeeEmail) {
    document.getElementById("fromEmail").value = employeeEmail;
  }
  if (vendorEmail) {
    document.getElementById("toEmail").value = vendorEmail;
  }

</script>
 -->
	<!-- ë¡œë”© ìŠ¤í”¼ë„ˆ (ì • ì¤‘ì•™ ë°°ì¹˜) -->
	<!-- <div class="d-flex align-items-center justify-content-center spinner-overlay" style="display:none;">
	  <div class="spinner-border" role="status">
	    <span class="visually-hidden">Loading...</span>
	  </div>
	</div> -->

   <div class="container my-4">
    <h2 class="mb-4">ë°œì£¼ì„œ ë³´ë‚´ê¸°</h2>
    <form id="mailForm" th:action="@{/mail/send}" method="post" enctype="multipart/form-data">
      <!-- CSRF í† í° (Spring Security ì‚¬ìš© ì‹œ) -->
      <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
      
      <!-- ë°œì‹  ì •ë³´ -->
      <div class="mb-3">
        <label for="fromEmail" class="form-label">ë©”ì¼ë°œì†¡ì£¼ì†Œ</label>
        <input type="email" id="fromEmail" name="fromEmail" class="form-control" readonly required>
      </div>
      <div class="mb-3">
        <label for="subject" class="form-label">ë©”ì¼ì œëª©</label>
        <input type="text" id="subject" name="subject" class="form-control" required>
      </div>
      <div class="mb-3">
        <label for="content" class="form-label">ë©”ì¼ë‚´ìš©</label>
        <textarea id="content" name="content" rows="6" class="form-control"></textarea>
      </div>
      <div class="mb-3">
        <label for="file" class="form-label">ì²¨ë¶€íŒŒì¼</label>
        <input type="file" id="file" name="file" class="form-control">
      </div>
      
      <!-- ìˆ˜ì‹  ì •ë³´ -->
      <hr>
      <h4 class="mt-4">ìˆ˜ì‹ ì •ë³´</h4>
      <div class="mb-3">
        <label for="toEmail" class="form-label">ë©”ì¼ìˆ˜ì‹ ì£¼ì†Œ</label>
        <input type="email" id="toEmail" name="toEmail" class="form-control" required>
      </div>
      <div class="d-flex justify-content-end">
       <button type="submit" class="btn btn-primary">ì „ì†¡</button>
      </div>
  
      </form>
  </div>
  
 
<script>
	
    // í¼ ì œì¶œì„ AJAX ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ì—¬ ì „ì†¡ ì„±ê³µ ì‹œ ì•Œë¦¼ í›„ í˜ì´ì§€ ë¦¬ë¡œë“œ
    document.getElementById("mailForm").addEventListener("submit", function(e) {
      e.preventDefault(); // ê¸°ë³¸ í¼ ì œì¶œ ì¤‘ë‹¨

      const form = e.target;
      const formData = new FormData(form);
      //const spinner = document.querySelector(".spinner-overlay");
		
   // ğŸ“Œ ìš”ì²­ ì‹œì‘ ì „ì— ìŠ¤í”¼ë„ˆ í‘œì‹œ
      //spinner.style.display = "flex";
   
      fetch(form.action, {
        method: "POST",
        body: formData
      })
      .then(response => response.json())
      .then(data => {
        if(data.status === "success") {
        	  // SweetAlert2ë¥¼ ì´ìš©í•´ ì„±ê³µ ëª¨ë‹¬ í‘œì‹œ
            Swal.fire({
              icon: 'success',
              title: 'ë©”ì¼ ë°œì†¡ ì„±ê³µ',
              text: 'ë©”ì¼ì´ ì„±ê³µì ìœ¼ë¡œ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.',
              confirmButtonText: 'í™•ì¸'
            }).then(() => {
              // ì‚¬ìš©ìê°€ í™•ì¸ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í˜ì´ì§€ë¥¼ ë¦¬ë¡œë“œ
              location.reload();
            });
          } else {
            Swal.fire({
              icon: 'error',
              title: 'ë©”ì¼ ë°œì†¡ ì‹¤íŒ¨',
              text: 'ë©”ì¼ ì „ì†¡ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.'
            });
          }
        })
        .catch(error => {
          console.error("ë©”ì¼ ë°œì†¡ ì˜¤ë¥˜:", error);
          Swal.fire({
            icon: 'error',
            title: 'ì˜¤ë¥˜ ë°œìƒ',
            text: 'ë©”ì¼ ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì˜€ìŠµë‹ˆë‹¤.'
          });
        })
        .finally(() => {
          // ğŸ“Œ ìš”ì²­ ì™„ë£Œ í›„ ìŠ¤í”¼ë„ˆ ìˆ¨ê¸°ê¸°
          //spinner.style.display = "none";
        });
      });
  </script>

  
</body>

