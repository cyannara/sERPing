<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<!-- âœ… Balham í…Œë§ˆ ìŠ¤íƒ€ì¼ ì ìš© -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@33.0.4/styles/ag-grid.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ag-grid-community@33.0.4/styles/ag-theme-balham.css">
  <!-- ag-Grid ë¼ì´ë¸ŒëŸ¬ë¦¬ -->
  <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@33.0.4/dist/ag-grid-community.min.js"></script>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>ê¸°ë³¸ì„œë²„</h1>
	<!-- ëª©ë¡ ì‹œì‘ -->
	<table class="table table-hover">
		<thead>
			<tr class="table-dark">
				<th>ìì‚°ì½”ë“œ</th>
				<th>ìì‚°ëª…</th>
			</tr>
		</thead>
		<tbody>
			<tr th:each="ele, idx : ${list}" th:class="${idx.count} % 2 == 0 ? 'table-primary' : 'table-success'">
				<td th:text="${ele.assetsCode}"></td>
				<td th:text="${ele.assetsName}"></td>
			</tr>
		</tbody>
	</table>
	<!-- ëª©ë¡ ë -->
	
	
	<h1>REST ì„œë²„</h1>
	<!-- ëª©ë¡ ì‹œì‘ -->
	<table class="table table-hover">
		<thead>
			<tr class="table-dark">
				<th>ìì‚°ì½”ë“œ</th>
				<th>ìì‚°ëª…</th>
				<th>êµ¬ë¶„</th>
			</tr>
		</thead>
		<tbody class="viewtable">
		</tbody>
	</table>
	<!-- ëª©ë¡ ë -->
	
	
	<h1>REST Ag-Grid</h1>
	<!-- ag-grid ì‹œì‘ -->
	<!-- âœ… í…Œë§ˆë¥¼ balhamìœ¼ë¡œ ë³€ê²½ -->
      <div id="myGrid" class="ag-theme-balham" style="width: 100%; height: 400px;"></div>
	<!-- ag-grid ë -->
</body>

<script th:inline="javascript">
	window.addEventListener("DOMContentLoaded", function() {
		testDbList();
		
		// âœ… ag-Grid ì´ˆê¸°í™”
	    const gridDiv = document.querySelector("#myGrid");
	    agGrid.createGrid(gridDiv, gridOptions);
	});
	
	//restì„œë²„ í˜¸ì¶œ
	function testDbList(){
		const url = `/accnut/rest/list`;
		fetch( url )
		.then( result => result.json() )
		.then( result => viewtableupdate(result) )
	}
	
	//JSON ë°ì´í„° ì²˜ë¦¬
	function viewtableupdate(result){
		
		//DOM í˜•ì‹ ì²˜ë¦¬
		result.forEach( (ele, idx) => {
			//console.log(ele);
			let rowClass = (idx % 2 === 0) ? "table-primary" : "table-success";
			let tag = `<tr class="${rowClass}">`;
			tag += `<td>${ele.assetsCode}</td>`;
			tag += `<td>${ele.assetsName}</td>`;
			tag += `<td>${ele.section}</td>`;
			tag += `</tr>`;
			
			//console.log(tag);
			document.querySelector(".viewtable").insertAdjacentHTML("beforeend", tag);
		});
		
		//ag-grid í˜•ì‹ ì²˜ë¦¬
		if (gridOptions.api) {
	      //ê·¸ë¦¬ë“œ ë‚´ë¶€ ë°ì´í„° ì‚­ì œí›„ ê¹¨ë—í•œ ê³µê°„ì²˜ë¦¬ í•˜ê¸°ìœ„í•œë°©ë²•
	      let allRows = [];
	      gridOptions.api.forEachNode(node => allRows.push(node.data)); // ëª¨ë“  í–‰ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
	      gridOptions.api.applyTransaction({ remove: allRows }); // âœ… ê¸°ì¡´ ë°ì´í„° ì‚­ì œ
	      //ê·¸ë¦¬ë“œì— ê°’ ë°€ì–´ë„£ê¸°
	      gridOptions.api.applyTransaction({ add: result }); // ìƒˆë¡œìš´ ë°ì´í„° ì¶”ê°€
	    } else {
	      console.error("ğŸš¨ Grid APIê°€ ì•„ì§ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
	    }
	}
	
	
	
	//ê·¸ë¦¬ë“œ ë°ì´í„° ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì •
	// âœ… ì´ˆê¸° ë°ì´í„° (API ìš”ì²­ ì „)
	var rowData = [
	  { testName: "í‘œí•˜ì—°", testAge: "37", },
	  { testName: "ì Šì€ë‚˜", testAge: "20", },
	];
	// âœ… ag-Grid ì„¤ì •
	const gridOptions = {
	  columnDefs: [
	    { headerName: "ìì‚°ì½”ë“œ", field: "assetsCode", },
	    { headerName: "ìì‚°ëª…", field: "assetsName", },
	    { headerName: "êµ¬ë¶„", field: "section", },
	    { headerName: "ê¸ˆìœµê¸°ê´€", field: "financialInstitution", },
	    { headerName: "ê²°ì œì •ë³´", field: "financeInformation", },
	    { headerName: "ì†Œìœ ì£¼", field: "owner", },
	    { headerName: "ê¸ˆì•¡", field: "amount", },
	    { headerName: "ë“±ë¡ì¼", field: "registerDate", },
	    { headerName: "ìˆ˜ëŸ‰", field: "quantity", },
	    { headerName: "ë¹„í’ˆê¸ˆì•¡", field: "fixturesAmount", },
	  ],
	  rowData: rowData, // âœ… ì´ˆê¸° ë°ì´í„° ì„¤ì • // ê¸°ì´ˆ ì…‹íŒ…ì´ í•„ìš”í•˜ë©´ rowDataë¡œ í•´ì„œ ê°’ ë„£ìœ¼ë©´ë¨
	  pagination: true,
	  theme: "legacy",
	  pagination: true, // âœ… í˜ì´ì§€ ë„¤ì´ì…˜ í™œì„±í™”
	  paginationPageSize: 5, // âœ… ê¸°ë³¸ í˜ì´ì§€ í¬ê¸° (5ê°œì”©)
	  paginationPageSizeSelector: [5, 10, 25, 50], // âœ… í˜ì´ì§€ í¬ê¸° ì„ íƒ ì˜µì…˜
	  domLayout: "autoHeight",  // âœ… ë†’ì´ ìë™ ì¡°ì •
	  suppressHorizontalScroll: false,  // âœ… ê°€ë¡œ ìŠ¤í¬ë¡¤ í—ˆìš©
	  defaultColDef: {
	    resizable: true,  // âœ… ì»¬ëŸ¼ í¬ê¸° ì¡°ì • ê°€ëŠ¥
	  },
	  //í•´ë‹¹ apië¥¼ ì˜¨ë ˆë’¤ ì‹œí‚¤ê³  ë°ì´í„° ë„£ëŠ”ê³³ì—ì„œ ë„£ì–´ì„œ ì“°ë©´ë¨
	  onGridReady: function (params) {
	    console.log("âœ… Grid Ready! API Initialized.");
	    gridOptions.api = params.api; // âœ… ag-Gridê°€ ì¤€ë¹„ëœ í›„ API ì €ì¥
	    gridOptions.api.sizeColumnsToFit(); // âœ… ìë™ í¬ê¸° ë§ì¶¤ [ ì´ê±°í•˜ë©´ ê°€ë¡œ ìŠ¤í¬ë¡¤ ì—†ì–´ì§ ]
	  },
	  // ê·¸ë¦¬ë“œì…€ í´ë¦­ ì´ë²¤íŠ¸
	  onCellClicked: function (event) { // âœ… ì…€ í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
	      
	  	//alert(`í´ë¦­í•œ ì…€ ê°’: ${event.value}`); // í´ë¦­í•œ ì…€ì˜ ê°’ ì¶œë ¥
	      
	      let rowData = event.data; // âœ… í´ë¦­í•œ í–‰ì˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
	      alert(`í´ë¦­í•œ í–‰ì˜ ë°ì´í„°:\n${JSON.stringify(rowData, null, 2)}`); // âœ… ì „ì²´ í–‰ ë°ì´í„° ì¶œë ¥
	  }
	};
</script>
</html>